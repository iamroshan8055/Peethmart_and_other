<!DOCTYPE html>
<html lang="en">

<head>

    <title title="Category Edit Page"> Category Edit Page </title>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../../css/AdminPro_edit.css" rel="stylesheet" type="text/css"/>
    <script src="../../js/config.js"></script>    <!-- config Bse urls JS -->

    <!-- Font Awesome CDN --> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/fontawesome.min.css" integrity="sha384-wESLQ85D6gbsF459vf1CiZ2+rr+CsxRY0RpiF1tLlQpDnAgg6rwdsUF1+Ics2bni" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" type="text/css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/duotone.css" integrity="sha384-R3QzTxyukP03CMqKFe0ssp5wUvBPEyy9ZspCB+Y01fEjhMwcXixTyeot+S40+AjZ" crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/fontawesome.css" integrity="sha384-eHoocPgXsiuZh+Yy6+7DsKAerLXyJmu2Hadh4QYyt+8v86geixVYwFqUvMU8X90l" crossorigin="anonymous"/>
    <script src="https://use.fontawesome.com/your-embed-code.js"></script> <!-- TODO: Place your Font Awesome embed code  -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css">

    <!-- Bootsrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>


</head>

<body>

    <div id="wrapper">

        <header>
            <a href="index.html"><h1 title="Admin Panel">Admin Panel</h1></a>
        </header>

        <nav>
            <div class="flex_container"></div>
                <ul>
                    <li><div id="flx_nav_1" class="active_nav"><a href="../index.html">Back</a></div></li>
                    <!-- <li><div id="flx_nav_2"><a href="recipe.html">Recipes</a></div></li>
                    <li><div id="flx_nav_3"><a href="about_us.html">About Us</a></div></li>
                    <li><div id="flx_nav_4"><a href="contact_us.html">Contact Us</a></div></li> -->
                </ul>
            </div>
        </nav>

        <main>
            <form action="#" method="POST" id="categoryedit" enctype ="multipart/form-data">
        
                <input type="hidden" name="edit_id" value="">
        
                <h2>Category Edit Page</h2>
    
                <div class="flx_1">
                    <img src="images/Home-Made-Raviolilatest.jpg" title="Click the image to replace it" class='img r recipe_imgs' id="img">
                </div>

                <!-- <h4>No Image</h4> -->

                <input style="display: none;" type="file" name="image" id="image">


                <div id="message"></div>

                <table border="0">
                    <!-- <tr>
                        <th> ID: </th>
                        <td><strong>1</strong></td>
                    </tr> -->
                    <tr>
                        <th> Name: </th>
                        <td><input type="text"  class="form-control"  name="cname" id="cname" required></td>
                    </tr>
                    <tr>
                        <th> Display Name: </th>
                        <td><input type="text"  class="form-control"  name="cdisname" id="cdisname" required></td>
                    </tr>
                    <!-- <tr>
                        <th> Parent: </th>
                        <td><input type="text"  class="form-control"  name="cparent" id="cparent" required></td>
                    </tr>
                    <tr>
                        <th> Product Count: </th>
                        <td><input type="number"  class="form-control"  name="cpcount" id="cpcount" required></td>
                    </tr> -->
                    <tr>
                        <th> Created by: </th>
                        <td><input type="text"  class="form-control"  name="ccreatedby" id="ccreatedby" readonly></td>
                    </tr>
                    <tr>
                        <th> Created at: </th>
                        <td><input type="text"  class="form-control"  name="ccreatedat" id="ccreatedat" readonly></td>
                    </tr>
                    <tr>
                        <th> Updated by: </th>
                        <td><input type="text"  class="form-control"  name="cupdatedby" id="cupdatedby" readonly></td>
                    </tr>
                    <tr>
                        <th> Updated at: </th>
                        <td><input type="text"  class="form-control"  name="cupdatedat" id="cupdatedat" readonly></td>
                    </tr>
                    
                </table>

                <button type="submit" class="btn btn-outline-success"><i class="far fa-save"></i> Save </button>
                <button type="reset" class="btn btn-warning"> Reset </button>
            </form>

        </main>

        <footer>
            Contact Us : <a href="mailto:peethmart@gmail.com">peethmart@gmail.com</a><br>
            Copyright &copy; 2021 Peethmart. All Rights Reserved. <a href="#">Terms & Conditions</a> | <a href="#">Privacy Policy</a>
        </footer>

    </div>

</body>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    $(document).ready(function(){
        $("img").click(function(){
            $("#image").click();
        });
        // $("h4").click(function(){
        //     $("#image").click();
        // });
    });
</script>

<Script>

    $(document).ready(function() {
            $(".message").remove();
			const url = BASE_URL+"/api/admin/category/";
			$.get(url, function(res){
                var myArray = res.data;
                buildTable(myArray) /* buildTable Function call */
			})
			  .fail(function(res){
				$('#message').append("<center><span class='message' style='color:red'>"+ res.responseJSON.message +"</span></center>");
			  });
			return false;
        });

        function buildTable(data){
        const id = window.location.search.split('=')[1]
        // console.log(id)
        var catname = document.getElementById('cname')
        var catdisname = document.getElementById('cdisname')
        var catcreatedby = document.getElementById('ccreatedby')
        var catcreatedat = document.getElementById('ccreatedat')
        var catupdatedby = document.getElementById('cupdatedby')
        var catupdatedat = document.getElementById('cupdatedat')

        catname.value = `${data[id-1].name}`
        catdisname.value = `${data[id-1].display_name}`
        catcreatedby.value = `${data[id-1].created_by}`
        cat_tempcrt = `${data[id-1].created_at}`

        yy = String(cat_tempcrt).slice(0, 4)
        mm = String(cat_tempcrt).slice(5, 7)
        dd = String(cat_tempcrt).slice(8, 10)
        tt = String(cat_tempcrt).slice(11, 13)
        ss = String(cat_tempcrt).slice(14, 16)
        ampm = "AM"
        if (Number(tt)>12) {
            tt = tt - 12
            ampm = "PM"
        }
        catcreatedat.value = dd +"/"+ mm +"/"+ yy +" "+ tt +":"+ ss +" "+ ampm
        
        catupdatedby.value = `${data[id-1].updated_by}`
        catupdatedat.value = `${data[id-1].updated_at}`

        // for (var i = 0; i < data.length; i++){
        //     var row = `${i+1} ${data[i].name}`
        //     table.innerHTML += row
        // }
    }

    // window.onload = function () {
    //     xyz = $("view_id").val();
    //     console.log(xyz);
    // };

    console.log("Category Name : ",document.getElementById('cname').innerHTML,$('#cname').val())
    console.log("Category Display Name : ",document.getElementById('cdisname').value,$('#cdisname').val())

    $(document).ready(function() {
		$("#categoryedit").submit(function()
		{
            $(".message").remove();
			const url = BASE_URL+"/api/admin/category/";
			const data = {  //"image" : $('#image').val(),
                            "name" : $('#cname').val(),
							"display_name" : $('#cdisname').val(),
                            //"parent" : $('#cparent').val(),
                            //"product count" : $('#cpcount').val(),
						}
			$.post(url, data, function(){
				alert("SUCCESS");
			})
			  .fail(function(res){
				$('#message').append("<center><span class='message' style='color:red'>"+ res.responseJSON.message +"</span></center>");
			  });
			return false;
        });
    });
</Script>

</html>